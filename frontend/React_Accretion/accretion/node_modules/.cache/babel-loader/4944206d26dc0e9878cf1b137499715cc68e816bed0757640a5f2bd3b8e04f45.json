{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState } from 'react';\nexport default function AuthJWT() {\n  _s();\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [jwt, setJWT] = useState(JSON.parse(localStorage.getItem('jwt')));\n  const checkJWT = token => {\n    fetch(\"http://localhost:8000/auth/jwt/verify/\", {\n      method: 'GET',\n      authentication: `JWT ${token}`\n    });\n  };\n  if (jwt) {\n    console.log(\"JWT exists\");\n    fetch(\"http://localhost:8000/auth/users/\", {\n      method: 'GET',\n      headers: {\n        'Authorization': `JWT ${jwt.access}`,\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      if (response.ok) {\n        setIsAuthenticated(true);\n      } else {\n        // refresh token \n        fetch(\"http://localhost:8000/auth/jwt/refresh/\", {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            \"refresh\": jwt.refresh\n          })\n        }).then(response => {\n          if (response.ok) {\n            console.log(\"successfully refreshed token\");\n            return response.json();\n          } else {\n            throw new Error(\"Failed to refresh token\");\n          }\n        }).then(data => {\n          setJWT(prevJWT => ({\n            ...prevJWT,\n            \"access\": data.access\n          }));\n          localStorage.setItem('jwt', JSON.stringify(jwt));\n        });\n      }\n    });\n  }\n  return isAuthenticated;\n}\n_s(AuthJWT, \"rHaUpzV/HCYewC7WOCMY+PHKYzY=\");\n_c = AuthJWT;\nvar _c;\n$RefreshReg$(_c, \"AuthJWT\");","map":{"version":3,"names":["useState","AuthJWT","_s","isAuthenticated","setIsAuthenticated","jwt","setJWT","JSON","parse","localStorage","getItem","checkJWT","token","fetch","method","authentication","console","log","headers","access","then","response","ok","body","stringify","refresh","json","Error","data","prevJWT","setItem","_c","$RefreshReg$"],"sources":["/Users/yxni-mbp/Dropbox (Personal)/Startup/Accretion/Website/frontend/React_Accretion/accretion/src/user-auth/AuthJWT.js"],"sourcesContent":["import {useState} from 'react';\n\nexport default function AuthJWT() {\n    \n    const [isAuthenticated, setIsAuthenticated] = useState(false);\n    const [jwt, setJWT] = useState(JSON.parse(localStorage.getItem('jwt')));\n\n    const checkJWT = (token) => {\n        fetch(\"http://localhost:8000/auth/jwt/verify/\", {\n            method: 'GET', \n            authentication: `JWT ${token}`\n        })\n    }\n\n    if (jwt) {\n        console.log(\"JWT exists\");\n        fetch(\"http://localhost:8000/auth/users/\", {\n            method: 'GET', \n            headers: {\n                'Authorization': `JWT ${jwt.access}`,\n                'Content-Type': 'application/json'\n            }\n        })\n        .then( response => {\n            if (response.ok) {\n                setIsAuthenticated(true);\n            } else {\n                // refresh token \n                fetch(\"http://localhost:8000/auth/jwt/refresh/\", {\n                    method: 'POST', \n                    headers: {\n                        'Content-Type': 'application/json'\n                    },\n                    body: JSON.stringify({\n                        \"refresh\": jwt.refresh\n                    })\n                })\n                .then( response => {\n                    if (response.ok) {\n                        console.log(\"successfully refreshed token\");\n                        return response.json();\n                    } else {\n                        throw new Error(\"Failed to refresh token\");\n                    }\n                })\n                .then( data => {\n                    setJWT((prevJWT) => ({\n                        ...prevJWT, \n                        \"access\": data.access\n                    }));\n                    localStorage.setItem('jwt', JSON.stringify(jwt));\n                })\n            }\n            })\n    }   \n\n    return isAuthenticated;\n}"],"mappings":";AAAA,SAAQA,QAAQ,QAAO,OAAO;AAE9B,eAAe,SAASC,OAAOA,CAAA,EAAG;EAAAC,EAAA;EAE9B,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGJ,QAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAACK,GAAG,EAAEC,MAAM,CAAC,GAAGN,QAAQ,CAACO,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;EAEvE,MAAMC,QAAQ,GAAIC,KAAK,IAAK;IACxBC,KAAK,CAAC,wCAAwC,EAAE;MAC5CC,MAAM,EAAE,KAAK;MACbC,cAAc,EAAG,OAAMH,KAAM;IACjC,CAAC,CAAC;EACN,CAAC;EAED,IAAIP,GAAG,EAAE;IACLW,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC;IACzBJ,KAAK,CAAC,mCAAmC,EAAE;MACvCC,MAAM,EAAE,KAAK;MACbI,OAAO,EAAE;QACL,eAAe,EAAG,OAAMb,GAAG,CAACc,MAAO,EAAC;QACpC,cAAc,EAAE;MACpB;IACJ,CAAC,CAAC,CACDC,IAAI,CAAEC,QAAQ,IAAI;MACf,IAAIA,QAAQ,CAACC,EAAE,EAAE;QACblB,kBAAkB,CAAC,IAAI,CAAC;MAC5B,CAAC,MAAM;QACH;QACAS,KAAK,CAAC,yCAAyC,EAAE;UAC7CC,MAAM,EAAE,MAAM;UACdI,OAAO,EAAE;YACL,cAAc,EAAE;UACpB,CAAC;UACDK,IAAI,EAAEhB,IAAI,CAACiB,SAAS,CAAC;YACjB,SAAS,EAAEnB,GAAG,CAACoB;UACnB,CAAC;QACL,CAAC,CAAC,CACDL,IAAI,CAAEC,QAAQ,IAAI;UACf,IAAIA,QAAQ,CAACC,EAAE,EAAE;YACbN,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;YAC3C,OAAOI,QAAQ,CAACK,IAAI,CAAC,CAAC;UAC1B,CAAC,MAAM;YACH,MAAM,IAAIC,KAAK,CAAC,yBAAyB,CAAC;UAC9C;QACJ,CAAC,CAAC,CACDP,IAAI,CAAEQ,IAAI,IAAI;UACXtB,MAAM,CAAEuB,OAAO,KAAM;YACjB,GAAGA,OAAO;YACV,QAAQ,EAAED,IAAI,CAACT;UACnB,CAAC,CAAC,CAAC;UACHV,YAAY,CAACqB,OAAO,CAAC,KAAK,EAAEvB,IAAI,CAACiB,SAAS,CAACnB,GAAG,CAAC,CAAC;QACpD,CAAC,CAAC;MACN;IACA,CAAC,CAAC;EACV;EAEA,OAAOF,eAAe;AAC1B;AAACD,EAAA,CAvDuBD,OAAO;AAAA8B,EAAA,GAAP9B,OAAO;AAAA,IAAA8B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}