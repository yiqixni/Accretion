{"ast":null,"code":"var _s = $RefreshSig$();\n/* \nAuthenticate user by check JWT access token, refresh the access the access token if invalid\n*/\n\nimport { useEffect } from 'react';\nimport { useAuth } from './AuthContext';\nimport CheckJWTaccess from './CheckJWTaccess';\nimport RefreshJWTaccess from './RefreshJWTaccess';\nexport default async function AuthJWT() {\n  _s();\n  const {\n    isLoggedIn,\n    login\n  } = useAuth();\n  if (isLoggedIn) {\n    return true;\n  }\n  const jwt = JSON.parse(localStorage.getItem('jwt'));\n  useEffect(() => {\n    if (jwt && jwt.access != \"\" && jwt.refresh != \"\") {\n      console.log(\"JWT token is found in local storage \", jwt);\n      CheckJWTaccess(jwt.access).then(response => {\n        console.log(\"checkJWTaccess response: \", response);\n        if (response == true) {\n          console.log(\"JWT access token is valid\");\n          login();\n        } else {\n          console.log(\"JWT access token is invalid, try to refresh\");\n          // try to refresh the JWT access token \n          RefreshJWTaccess(jwt.refresh).then(response => {\n            if (response) {\n              login();\n            }\n          }).catch(error => {\n            console.log(\"refresh token failed\");\n            console.log(error);\n          });\n        }\n      }).catch(error => {\n        console.log(\"validate JWT access token failed\");\n        console.log(error);\n      });\n    }\n  }, []);\n}\n_s(AuthJWT, \"VvxoFpDcwxHDlRD0UQWm5xMCDD4=\", false, function () {\n  return [useAuth];\n});\n_c = AuthJWT;\nvar _c;\n$RefreshReg$(_c, \"AuthJWT\");","map":{"version":3,"names":["useEffect","useAuth","CheckJWTaccess","RefreshJWTaccess","AuthJWT","_s","isLoggedIn","login","jwt","JSON","parse","localStorage","getItem","access","refresh","console","log","then","response","catch","error","_c","$RefreshReg$"],"sources":["/Users/yxni-mbp/Dropbox (Personal)/Startup/Accretion/Website/frontend/React_Accretion/accretion/src/user-auth/AuthJWT.js"],"sourcesContent":["/* \nAuthenticate user by check JWT access token, refresh the access the access token if invalid\n*/\n\n\nimport { useEffect } from 'react';\nimport { useAuth } from './AuthContext'; \n\nimport CheckJWTaccess from './CheckJWTaccess'; \nimport RefreshJWTaccess from './RefreshJWTaccess';\n\nexport default async function AuthJWT() {\n    const { isLoggedIn, login } = useAuth(); \n\n    if (isLoggedIn) {\n        return true; \n    }\n    \n    const jwt = JSON.parse(localStorage.getItem('jwt')); \n\n    useEffect(() => {\n        if (jwt && jwt.access != \"\" && jwt.refresh != \"\") {\n            console.log(\"JWT token is found in local storage \", jwt);\n            CheckJWTaccess(jwt.access) \n            .then( response => {\n                console.log(\"checkJWTaccess response: \", response);\n                if (response == true) {\n                    console.log(\"JWT access token is valid\");\n                    login(); \n                } else { \n                    console.log(\"JWT access token is invalid, try to refresh\");\n                    // try to refresh the JWT access token \n                    RefreshJWTaccess(jwt.refresh)\n                    .then( response => {\n                        if (response) {\n                            login();\n                        }\n                    })\n                    .catch( (error) => {\n                        console.log(\"refresh token failed\");\n                        console.log(error);\n                    })\n                }\n            })\n            .catch((error) => {\n                console.log(\"validate JWT access token failed\");\n                console.log(error);\n            })\n        }\n    },[]);\n}"],"mappings":";AAAA;AACA;AACA;;AAGA,SAASA,SAAS,QAAQ,OAAO;AACjC,SAASC,OAAO,QAAQ,eAAe;AAEvC,OAAOC,cAAc,MAAM,kBAAkB;AAC7C,OAAOC,gBAAgB,MAAM,oBAAoB;AAEjD,eAAe,eAAeC,OAAOA,CAAA,EAAG;EAAAC,EAAA;EACpC,MAAM;IAAEC,UAAU;IAAEC;EAAM,CAAC,GAAGN,OAAO,CAAC,CAAC;EAEvC,IAAIK,UAAU,EAAE;IACZ,OAAO,IAAI;EACf;EAEA,MAAME,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC,CAAC;EAEnDZ,SAAS,CAAC,MAAM;IACZ,IAAIQ,GAAG,IAAIA,GAAG,CAACK,MAAM,IAAI,EAAE,IAAIL,GAAG,CAACM,OAAO,IAAI,EAAE,EAAE;MAC9CC,OAAO,CAACC,GAAG,CAAC,sCAAsC,EAAER,GAAG,CAAC;MACxDN,cAAc,CAACM,GAAG,CAACK,MAAM,CAAC,CACzBI,IAAI,CAAEC,QAAQ,IAAI;QACfH,OAAO,CAACC,GAAG,CAAC,2BAA2B,EAAEE,QAAQ,CAAC;QAClD,IAAIA,QAAQ,IAAI,IAAI,EAAE;UAClBH,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC;UACxCT,KAAK,CAAC,CAAC;QACX,CAAC,MAAM;UACHQ,OAAO,CAACC,GAAG,CAAC,6CAA6C,CAAC;UAC1D;UACAb,gBAAgB,CAACK,GAAG,CAACM,OAAO,CAAC,CAC5BG,IAAI,CAAEC,QAAQ,IAAI;YACf,IAAIA,QAAQ,EAAE;cACVX,KAAK,CAAC,CAAC;YACX;UACJ,CAAC,CAAC,CACDY,KAAK,CAAGC,KAAK,IAAK;YACfL,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;YACnCD,OAAO,CAACC,GAAG,CAACI,KAAK,CAAC;UACtB,CAAC,CAAC;QACN;MACJ,CAAC,CAAC,CACDD,KAAK,CAAEC,KAAK,IAAK;QACdL,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAC;QAC/CD,OAAO,CAACC,GAAG,CAACI,KAAK,CAAC;MACtB,CAAC,CAAC;IACN;EACJ,CAAC,EAAC,EAAE,CAAC;AACT;AAACf,EAAA,CAvC6BD,OAAO;EAAA,QACHH,OAAO;AAAA;AAAAoB,EAAA,GADXjB,OAAO;AAAA,IAAAiB,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}